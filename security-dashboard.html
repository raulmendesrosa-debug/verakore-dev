<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verakore Security Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .security-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .security-score {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .security-label {
            font-size: 1rem;
            opacity: 0.9;
        }
        .status-critical { color: #dc3545; }
        .status-high { color: #fd7e14; }
        .status-medium { color: #ffc107; }
        .status-low { color: #28a745; }
        .status-good { color: #20c997; }
        .chart-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .vulnerability-card {
            border-left: 4px solid #dc3545;
            background: #f8d7da;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
        }
        .security-header-card {
            border-left: 4px solid #17a2b8;
            background: #d1ecf1;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
        }
        .owasp-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 4px solid #6c757d;
        }
        .owasp-item.passed {
            border-left-color: #28a745;
            background: #d4edda;
        }
        .owasp-item.failed {
            border-left-color: #dc3545;
            background: #f8d7da;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <div class="col-12">
                <h1 class="text-center my-4">
                    <i class="fas fa-shield-alt"></i> Verakore Security Dashboard
                </h1>
            </div>
        </div>

        <!-- Security Overview -->
        <div class="row">
            <div class="col-12">
                <h3><i class="fas fa-shield-alt"></i> Security Overview</h3>
            </div>
            <div class="col-md-3">
                <div class="security-card">
                    <div class="security-score" id="overall-score">--</div>
                    <div class="security-label">Overall Security Score</div>
                    <div class="security-label" id="overall-status">Loading...</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="security-card">
                    <div class="security-score" id="critical-count">--</div>
                    <div class="security-label">Critical Vulnerabilities</div>
                    <div class="security-label" id="critical-status">Loading...</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="security-card">
                    <div class="security-score" id="high-count">--</div>
                    <div class="security-label">High Vulnerabilities</div>
                    <div class="security-label" id="high-status">Loading...</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="security-card">
                    <div class="security-score" id="medium-count">--</div>
                    <div class="security-label">Medium Vulnerabilities</div>
                    <div class="security-label" id="medium-status">Loading...</div>
                </div>
            </div>
        </div>

        <!-- Security Headers -->
        <div class="row">
            <div class="col-md-6">
                <h3><i class="fas fa-headers"></i> Security Headers</h3>
                <div id="headers-container">
                    <div class="alert alert-info">Loading security headers...</div>
                </div>
            </div>
            <div class="col-md-6">
                <h3><i class="fas fa-lock"></i> SSL/TLS Security</h3>
                <div id="ssl-container">
                    <div class="alert alert-info">Loading SSL information...</div>
                </div>
            </div>
        </div>

        <!-- Charts -->
        <div class="row">
            <div class="col-md-6">
                <div class="chart-container">
                    <h5><i class="fas fa-chart-line"></i> Security Score Trends</h5>
                    <canvas id="securityChart"></canvas>
                </div>
            </div>
            <div class="col-md-6">
                <div class="chart-container">
                    <h5><i class="fas fa-chart-pie"></i> Vulnerability Distribution</h5>
                    <canvas id="vulnerabilityChart"></canvas>
                </div>
            </div>
        </div>

        <!-- OWASP Top 10 -->
        <div class="row">
            <div class="col-12">
                <h3><i class="fas fa-list"></i> OWASP Top 10 Compliance</h3>
                <div id="owasp-container">
                    <div class="alert alert-info">Loading OWASP compliance...</div>
                </div>
            </div>
        </div>

        <!-- Active Vulnerabilities -->
        <div class="row">
            <div class="col-12">
                <h3><i class="fas fa-exclamation-triangle"></i> Active Vulnerabilities</h3>
                <div id="vulnerabilities-container">
                    <div class="alert alert-info">Loading vulnerabilities...</div>
                </div>
            </div>
        </div>

        <!-- Security Recommendations -->
        <div class="row">
            <div class="col-12">
                <h3><i class="fas fa-lightbulb"></i> Security Recommendations</h3>
                <div id="recommendations-container">
                    <div class="alert alert-info">Loading recommendations...</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Security Dashboard JavaScript
        class SecurityDashboard {
            constructor() {
                this.charts = {};
                this.init();
            }

            init() {
                this.loadData();
                this.setupCharts();
                this.startAutoRefresh();
            }

            async loadData() {
                try {
                    // Simulate API call - replace with actual endpoint
                    const response = await fetch('/api/security-data');
                    const data = await response.json();
                    this.updateDashboard(data);
                } catch (error) {
                    console.error('Error loading security data:', error);
                    this.loadSampleData();
                }
            }

            loadSampleData() {
                // Sample data for demonstration
                const sampleData = {
                    overallScore: 85,
                    vulnerabilities: {
                        critical: 0,
                        high: 2,
                        medium: 3,
                        low: 5
                    },
                    securityHeaders: [
                        { name: 'X-Frame-Options', status: 'GOOD', value: 'DENY' },
                        { name: 'X-Content-Type-Options', status: 'GOOD', value: 'nosniff' },
                        { name: 'X-XSS-Protection', status: 'GOOD', value: '1; mode=block' },
                        { name: 'Content-Security-Policy', status: 'WARNING', value: 'default-src self' },
                        { name: 'Strict-Transport-Security', status: 'MISSING', value: null }
                    ],
                    ssl: {
                        enabled: true,
                        score: 90,
                        certificate: 'Valid',
                        cipher: 'TLS_AES_256_GCM_SHA384'
                    },
                    owasp: [
                        { id: 'A01', name: 'Broken Access Control', status: 'PASSED' },
                        { id: 'A02', name: 'Cryptographic Failures', status: 'PASSED' },
                        { id: 'A03', name: 'Injection', status: 'FAILED' },
                        { id: 'A04', name: 'Insecure Design', status: 'PASSED' },
                        { id: 'A05', name: 'Security Misconfiguration', status: 'WARNING' },
                        { id: 'A06', name: 'Vulnerable Components', status: 'PASSED' },
                        { id: 'A07', name: 'Identification Failures', status: 'PASSED' },
                        { id: 'A08', name: 'Software Data Integrity', status: 'PASSED' },
                        { id: 'A09', name: 'Logging Monitoring Failures', status: 'PASSED' },
                        { id: 'A10', name: 'Server-Side Request Forgery', status: 'PASSED' }
                    ],
                    activeVulnerabilities: [
                        {
                            type: 'XSS',
                            severity: 'HIGH',
                            description: 'Potential XSS vulnerability in contact form',
                            location: '/contact',
                            recommendation: 'Implement input validation and output encoding'
                        },
                        {
                            type: 'Missing Security Header',
                            severity: 'MEDIUM',
                            description: 'Missing Strict-Transport-Security header',
                            location: 'All pages',
                            recommendation: 'Add HSTS header to server configuration'
                        }
                    ],
                    trends: [
                        { date: '2024-01-01', score: 78, vulnerabilities: 12 },
                        { date: '2024-01-02', score: 82, vulnerabilities: 10 },
                        { date: '2024-01-03', score: 85, vulnerabilities: 8 },
                        { date: '2024-01-04', score: 83, vulnerabilities: 9 },
                        { date: '2024-01-05', score: 85, vulnerabilities: 8 }
                    ]
                };

                this.updateDashboard(sampleData);
            }

            updateDashboard(data) {
                this.updateSecurityOverview(data);
                this.updateSecurityHeaders(data.securityHeaders);
                this.updateSSLInfo(data.ssl);
                this.updateOWASP(data.owasp);
                this.updateVulnerabilities(data.activeVulnerabilities);
                this.updateCharts(data.trends, data.vulnerabilities);
            }

            updateSecurityOverview(data) {
                document.getElementById('overall-score').textContent = data.overallScore;
                document.getElementById('overall-status').textContent = this.getScoreStatus(data.overallScore);
                document.getElementById('overall-status').className = `security-label ${this.getScoreClass(data.overallScore)}`;

                document.getElementById('critical-count').textContent = data.vulnerabilities.critical;
                document.getElementById('critical-status').textContent = data.vulnerabilities.critical === 0 ? 'Good' : 'Critical';
                document.getElementById('critical-status').className = `security-label ${data.vulnerabilities.critical === 0 ? 'status-good' : 'status-critical'}`;

                document.getElementById('high-count').textContent = data.vulnerabilities.high;
                document.getElementById('high-status').textContent = data.vulnerabilities.high <= 2 ? 'Acceptable' : 'High Risk';
                document.getElementById('high-status').className = `security-label ${data.vulnerabilities.high <= 2 ? 'status-medium' : 'status-high'}`;

                document.getElementById('medium-count').textContent = data.vulnerabilities.medium;
                document.getElementById('medium-status').textContent = data.vulnerabilities.medium <= 5 ? 'Manageable' : 'Needs Attention';
                document.getElementById('medium-status').className = `security-label ${data.vulnerabilities.medium <= 5 ? 'status-low' : 'status-medium'}`;
            }

            updateSecurityHeaders(headers) {
                const container = document.getElementById('headers-container');
                
                container.innerHTML = headers.map(header => `
                    <div class="security-header-card">
                        <h6><i class="fas fa-shield-alt"></i> ${header.name}</h6>
                        <p><strong>Status:</strong> <span class="badge ${this.getHeaderBadgeClass(header.status)}">${header.status}</span></p>
                        <p><strong>Value:</strong> ${header.value || 'Not Set'}</p>
                    </div>
                `).join('');
            }

            updateSSLInfo(ssl) {
                const container = document.getElementById('ssl-container');
                
                container.innerHTML = `
                    <div class="security-header-card">
                        <h6><i class="fas fa-lock"></i> SSL/TLS Status</h6>
                        <p><strong>Enabled:</strong> <span class="badge ${ssl.enabled ? 'bg-success' : 'bg-danger'}">${ssl.enabled ? 'Yes' : 'No'}</span></p>
                        <p><strong>Score:</strong> <span class="badge ${this.getScoreBadgeClass(ssl.score)}">${ssl.score}/100</span></p>
                        <p><strong>Certificate:</strong> ${ssl.certificate}</p>
                        <p><strong>Cipher:</strong> ${ssl.cipher}</p>
                    </div>
                `;
            }

            updateOWASP(owasp) {
                const container = document.getElementById('owasp-container');
                
                container.innerHTML = owasp.map(item => `
                    <div class="owasp-item ${item.status.toLowerCase()}">
                        <h6><i class="fas fa-shield-alt"></i> ${item.id}: ${item.name}</h6>
                        <p><strong>Status:</strong> <span class="badge ${this.getOWASPBadgeClass(item.status)}">${item.status}</span></p>
                    </div>
                `).join('');
            }

            updateVulnerabilities(vulnerabilities) {
                const container = document.getElementById('vulnerabilities-container');
                
                if (vulnerabilities.length === 0) {
                    container.innerHTML = '<div class="alert alert-success">No active vulnerabilities found</div>';
                    return;
                }

                container.innerHTML = vulnerabilities.map(vuln => `
                    <div class="vulnerability-card">
                        <h6><i class="fas fa-exclamation-triangle"></i> ${vuln.type}</h6>
                        <p><strong>Severity:</strong> <span class="badge ${this.getSeverityBadgeClass(vuln.severity)}">${vuln.severity}</span></p>
                        <p><strong>Location:</strong> ${vuln.location}</p>
                        <p><strong>Description:</strong> ${vuln.description}</p>
                        <p><strong>Recommendation:</strong> ${vuln.recommendation}</p>
                    </div>
                `).join('');
            }

            setupCharts() {
                this.setupSecurityChart();
                this.setupVulnerabilityChart();
            }

            setupSecurityChart() {
                const ctx = document.getElementById('securityChart').getContext('2d');
                this.charts.security = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: [],
                        datasets: [
                            {
                                label: 'Security Score',
                                data: [],
                                borderColor: '#667eea',
                                backgroundColor: 'rgba(102, 126, 234, 0.1)',
                                tension: 0.4
                            },
                            {
                                label: 'Vulnerabilities',
                                data: [],
                                borderColor: '#dc3545',
                                backgroundColor: 'rgba(220, 53, 69, 0.1)',
                                tension: 0.4
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }

            setupVulnerabilityChart() {
                const ctx = document.getElementById('vulnerabilityChart').getContext('2d');
                this.charts.vulnerability = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Critical', 'High', 'Medium', 'Low'],
                        datasets: [{
                            data: [0, 2, 3, 5],
                            backgroundColor: [
                                '#dc3545',
                                '#fd7e14',
                                '#ffc107',
                                '#28a745'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
            }

            updateCharts(trends, vulnerabilities) {
                if (trends) {
                    this.charts.security.data.labels = trends.map(t => t.date);
                    this.charts.security.data.datasets[0].data = trends.map(t => t.score);
                    this.charts.security.data.datasets[1].data = trends.map(t => t.vulnerabilities);
                    this.charts.security.update();
                }

                if (vulnerabilities) {
                    this.charts.vulnerability.data.datasets[0].data = [
                        vulnerabilities.critical,
                        vulnerabilities.high,
                        vulnerabilities.medium,
                        vulnerabilities.low
                    ];
                    this.charts.vulnerability.update();
                }
            }

            getScoreStatus(score) {
                if (score >= 90) return 'Excellent';
                if (score >= 80) return 'Good';
                if (score >= 70) return 'Fair';
                if (score >= 60) return 'Poor';
                return 'Critical';
            }

            getScoreClass(score) {
                if (score >= 80) return 'status-good';
                if (score >= 70) return 'status-medium';
                if (score >= 60) return 'status-high';
                return 'status-critical';
            }

            getHeaderBadgeClass(status) {
                switch (status) {
                    case 'GOOD': return 'bg-success';
                    case 'WARNING': return 'bg-warning';
                    case 'MISSING': return 'bg-danger';
                    default: return 'bg-secondary';
                }
            }

            getScoreBadgeClass(score) {
                if (score >= 80) return 'bg-success';
                if (score >= 60) return 'bg-warning';
                return 'bg-danger';
            }

            getOWASPBadgeClass(status) {
                switch (status) {
                    case 'PASSED': return 'bg-success';
                    case 'WARNING': return 'bg-warning';
                    case 'FAILED': return 'bg-danger';
                    default: return 'bg-secondary';
                }
            }

            getSeverityBadgeClass(severity) {
                switch (severity) {
                    case 'CRITICAL': return 'bg-danger';
                    case 'HIGH': return 'bg-warning';
                    case 'MEDIUM': return 'bg-info';
                    case 'LOW': return 'bg-success';
                    default: return 'bg-secondary';
                }
            }

            startAutoRefresh() {
                setInterval(() => {
                    this.loadData();
                }, 300000); // Refresh every 5 minutes
            }
        }

        // Initialize dashboard when page loads
        document.addEventListener('DOMContentLoaded', () => {
            new SecurityDashboard();
        });
    </script>
</body>
</html>
